# =============================================================================
# Small-Squaretable Environment Configuration
# =============================================================================
# Copy this file to .env and update values for your environment
# NEVER commit .env files with real credentials to version control
# =============================================================================

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
# Environment: development | staging | production
NODE_ENV=development

# Server binding
HOST=0.0.0.0
PORT=3000

# Application URL (used for CORS, callbacks, etc.)
APP_URL=http://localhost:3000

# API version prefix
API_VERSION=v1

# -----------------------------------------------------------------------------
# Database Configuration (PostgreSQL)
# -----------------------------------------------------------------------------
# Connection URL format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://user:password@localhost:5432/sillytavern_saas

# Connection pool settings
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10

# SSL mode for production: require | verify-full | disable
DATABASE_SSL_MODE=disable

# -----------------------------------------------------------------------------
# Redis Configuration
# -----------------------------------------------------------------------------
# Connection URL format: redis://[:password@]host:port[/database]
REDIS_URL=redis://localhost:6379

# Redis password (leave empty if no auth)
REDIS_PASSWORD=

# Redis database number (0-15)
REDIS_DB=0

# Connection timeout in milliseconds
REDIS_CONNECT_TIMEOUT=5000

# -----------------------------------------------------------------------------
# Authentication (JWT)
# -----------------------------------------------------------------------------
# CRITICAL: Change these in production! Use at least 32 random characters
# Generate with: openssl rand -base64 32
JWT_SECRET=your-secret-key-change-in-production-min-32-chars
JWT_REFRESH_SECRET=your-refresh-secret-key-change-in-production

# Token expiration times
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# -----------------------------------------------------------------------------
# Security Settings
# -----------------------------------------------------------------------------
# CSRF protection (enable in production)
CSRF_ENABLED=true

# CORS allowed origins (comma-separated for multiple)
CORS_ORIGINS=http://localhost:5173,http://localhost:3000

# Rate limiting (requests per window)
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# Bcrypt salt rounds (higher = more secure but slower)
BCRYPT_SALT_ROUNDS=12

# -----------------------------------------------------------------------------
# Storage Configuration
# -----------------------------------------------------------------------------
# Storage type: local | s3
STORAGE_TYPE=local
STORAGE_PATH=./uploads

# S3 Configuration (required if STORAGE_TYPE=s3)
S3_BUCKET=
S3_REGION=us-east-1
S3_ACCESS_KEY=
S3_SECRET_KEY=
S3_ENDPOINT=                    # Optional: for S3-compatible services (MinIO, etc.)

# File upload limits
MAX_FILE_SIZE_MB=10
ALLOWED_FILE_TYPES=image/png,image/jpeg,image/gif,image/webp

# -----------------------------------------------------------------------------
# LLM Provider Configuration
# -----------------------------------------------------------------------------
# OpenAI
OPENAI_API_KEY=
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_DEFAULT_MODEL=gpt-4

# Anthropic
ANTHROPIC_API_KEY=
ANTHROPIC_BASE_URL=https://api.anthropic.com/v1
ANTHROPIC_DEFAULT_MODEL=claude-3-opus-20240229

# Custom LLM Provider (for self-hosted or alternative providers)
CUSTOM_LLM_API_KEY=
CUSTOM_LLM_BASE_URL=
CUSTOM_LLM_MODELS=model1,model2,model3
CUSTOM_LLM_DEFAULT_MODEL=model1

# LLM request settings
LLM_REQUEST_TIMEOUT_MS=120000
LLM_MAX_RETRIES=3

# -----------------------------------------------------------------------------
# Stripe Payment Configuration
# -----------------------------------------------------------------------------
# API Keys - Get from https://dashboard.stripe.com/apikeys
# Use sk_test_* for development, sk_live_* for production
STRIPE_SECRET_KEY=sk_test_your_secret_key_here
STRIPE_PUBLISHABLE_KEY=pk_test_your_publishable_key_here

# Webhook secret - Get from Stripe CLI or Dashboard webhook settings
# stripe listen --forward-to localhost:3000/api/v1/webhooks/stripe
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret_here

# Price IDs - Create products in Stripe Dashboard and copy price IDs
# Pro Plan: $19.99/month or $199.99/year
STRIPE_PRICE_PRO_MONTHLY=price_your_pro_monthly_id
STRIPE_PRICE_PRO_YEARLY=price_your_pro_yearly_id

# Team Plan: $99.99/month
STRIPE_PRICE_TEAM_MONTHLY=price_your_team_monthly_id

# Trial period in days (0 to disable)
STRIPE_TRIAL_PERIOD_DAYS=14

# -----------------------------------------------------------------------------
# Monitoring & Observability
# -----------------------------------------------------------------------------
# Sentry error tracking
# Get DSN from https://sentry.io/settings/projects/
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# Logging configuration
# Levels: debug | info | warn | error
LOG_LEVEL=info
LOG_FORMAT=json                 # json | pretty

# Health check settings
HEALTH_CHECK_INTERVAL_MS=30000

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------
# Enable/disable features
FEATURE_MARKETPLACE=true
FEATURE_SUBSCRIPTIONS=true
FEATURE_WEBSOCKET_CHAT=true
FEATURE_CHARACTER_IMPORT=true

# -----------------------------------------------------------------------------
# Email Configuration (for notifications)
# -----------------------------------------------------------------------------
# SMTP settings
SMTP_HOST=
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=noreply@example.com

# -----------------------------------------------------------------------------
# Production Deployment Checklist
# -----------------------------------------------------------------------------
# Before deploying to production, ensure:
#
# 1. Security:
#    [ ] JWT_SECRET and JWT_REFRESH_SECRET are unique, random 32+ char strings
#    [ ] DATABASE_URL uses strong password and SSL (DATABASE_SSL_MODE=require)
#    [ ] REDIS_PASSWORD is set if Redis is exposed
#    [ ] CSRF_ENABLED=true
#    [ ] CORS_ORIGINS only includes your production domains
#
# 2. Stripe:
#    [ ] Using sk_live_* keys (not sk_test_*)
#    [ ] Webhook endpoint configured in Stripe Dashboard
#    [ ] Price IDs point to production products
#
# 3. Monitoring:
#    [ ] SENTRY_DSN configured for error tracking
#    [ ] LOG_LEVEL=info or LOG_LEVEL=warn
#    [ ] NODE_ENV=production
#
# 4. Storage:
#    [ ] S3 configured for production file storage
#    [ ] Backup strategy in place for uploads
#
# 5. Database:
#    [ ] Connection pooling configured appropriately
#    [ ] Migrations applied
#    [ ] Backup strategy in place

